<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<style>
			.reveal div.more {
				position: fixed;
				left: 0;
				bottom: 0;
				font-size: .5em;
			}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section data-markdown>
						<script type="text/template">
							# Composer in Drupal
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							## What is Composer?

							> Composer is a tool for dependency management in PHP. It allows you to declare the libraries your project depends on and it will manage (install/update) them for you.
							<!-- .element: class="fragment" data-fragment-index="1" -->
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							## What do you mean by library?

							- standalone PHP library (i.e. PHPSpreadshead) <!-- .element: class="fragment" data-fragment-index="1" -->
							- Drupal theme <!-- .element: class="fragment" data-fragment-index="2" -->
							- Drupal module <!-- .element: class="fragment" data-fragment-index="3" -->
							- Drush command <!-- .element: class="fragment" data-fragment-index="4" -->
							- Drupal core <!-- .element: class="fragment" data-fragment-index="5" -->
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							1. Many Drupal modules already use Composer (i.e. Monolog, Payment Gateways, Sparkpost, etc) <!-- .element: class="fragment" data-fragment-index="1" -->
							1. It's written in PHP - something you already know. <!-- .element: class="fragment" data-fragment-index="2" -->
							1. Drupal 8 core requires Composer libraries ("getting off the island" - Guzzle, Symfony Routing). <!-- .element: class="fragment" data-fragment-index="3" -->
						</script>
					</section>
				</section>
				<section>
					<section data-markdown>
						<script type="text/template">
							## Let's talk about
							## pros and cons <!-- .element: class="fragment" data-fragment-index="1" -->
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							### Pros:
							- dependency declaration instead of library codebase <!-- .element: class="fragment" data-fragment-index="1" -->
							- project repository has only relevant code <!-- .element: class="fragment" data-fragment-index="2" -->
							- reuse modules, themes, libs... <!-- .element: class="fragment" data-fragment-index="3" -->
							- ...to specific SHA (composer.lock)<!-- .element: class="fragment" data-fragment-index="4" -->
							- avoid dependency conflicts <!-- .element: class="fragment" data-fragment-index="5" -->
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							- use different repositories seamlessly <!-- .element: class="fragment" data-fragment-index="1" -->
							- semver compatible version strib <!-- .element: class="fragment" data-fragment-index="2" -->
							- standardized workflow for D7 and D8 <!-- .element: class="fragment" data-fragment-index="3" -->
							- use local version of drush/drupal console etc. <!-- .element: class="fragment" data-fragment-index="4" -->
						</script>
					</section>
				</section>
				<section>
					<section data-markdown>
						<script type="text/template">
							## That is great but where fo find libraries?
						</script>
					</section>
					<section data-markdown>
						<script type="text/template">
							### packagist.org
						</script>
					</section>
					<section>
						<p class="fragment strike">packagist.drupal-composer.org</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">packages.drupal.org/7</p>
						<p class="fragment">packages.drupal.org/8</p>
						<div class="more"><a href="https://www.drupal.org/docs/develop/using-composer/using-composer-to-manage-drupal-site-dependencies">Read more</a></div>
					</section>
				</section>
				<section>
					<section data-markdown>
						<script type="text/template">
							## Composer vs Drush

							What does it mean in practice?  <!-- .element: class="fragment" data-fragment-index="1" -->
						</script>
					</section>
					<section>
						<h3>Composer dependency in D7</h3>
						<p>
							<code>
								$ drush composer-manager install
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ composer install
							</code>
						</p>
					</section>
					<section>
						<p>
							<code>
								$ drush dl rules
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ composer require drupal/rules
							</code>
						</p>
					</section>
					<section>
						<p>
							<code>
								$ drush up rules
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ composer update drupal/rules --with-dependencies
							</code>
						</p>
					</section>
					<section>
						<h2>Distribution?</h2>
						<p>
							<code>
								$ drush make
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ composer create-project drupal/commerce
							</code>
						</p>
					</section>
				</section>
				<section>
					<section data-markdown>
						## Custom commands
					</section>
					<section>
						<pre>
"scripts": {
	"test-style": "./vendor/bin/phpcs"
}
						</pre>
					</section>
					<section>
						<pre>
"scripts": {
	"test": [
		"./vendor/bin/phpcs",
		"./vendor/bin/behat"
	]
}
						</pre>
					</section>
					<section>
						<pre style="white-space: pre-line">
"scripts": {
	"drupal-scaffold": "DrupalComposer\\DrupalScaffold\\Plugin::scaffold"
}
						</pre>
					</section>
					<section>
						<p>
							<code>
								$ composer import
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ drush cim // Drupal 8
							</code>
						</p>
						<p class="fragment">
							<code>
								$ drush fra // Drupal 7
							</code>
						</p>
					</section>
					<section>
						<p>
							<code>
								$ composer export
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ drush cex // Drupal 8
							</code>
						</p>
						<p class="fragment">
							<code>
								$ drush fua // Drupal 7
							</code>
						</p>
					</section>
					<section>
						<p>
							<code>
								$ composer test
							</code>
						</p>
						<img src="https://cdn4.iconfinder.com/data/icons/action-hand-drawn-basic-sticker/64/arrow-down-128.png" style="background:none; border:none; box-shadow:none;" class="fragment">
						<p class="fragment">
							<code>
								$ ./vendor/bin/phpcs<br>
								$ ./vendor/bin/behat
							</code>
						</p>
					</section>
					<section data-markdown>
						<script type="text/template">
							```bash
							$ composer build
							```
							i.e.
							<!-- .element: class="fragment" data-fragment-index="1" -->
							```json
							"build": [
								"./vendor/bin/drush --root=$(pwd)/drupal cc drush",
								"@composer install --no-dev --prefer-dist",
								"./vendor/bin/drush --root=$(pwd)/drupal @sites features-revert-all -y",
								"./vendor/bin/drush --root=$(pwd)/drupal @sites updatedb -y",
								"./vendor/bin/drush --root=$(pwd)/drupal @sites l10n-update-refresh -y",
								"./vendor/bin/drush --root=$(pwd)/drupal @sites l10n-update -y",
								"./vendor/bin/drush --root=$(pwd)/drupal @sites cache-clear all -y"
							]
							```
							<!-- .element: class="fragment" data-fragment-index="1" -->
						</script>
					</section>
				</section>
				<section>
					<section data-background-image="http://i.giphy.com/mGj3SVN7xbPQ4.gif">

					</section>
					<section data-markdown>
						<script type="text/template">
							## Questions?
						</script>
					</section>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
